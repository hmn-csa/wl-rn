
import * as consts from '../consts'
import { takeLatest, call, put, take } from "redux-saga/effects";
import axios from "axios";


// watcher saga: watches for actions dispatched to the store, starts worker saga
export function* watcherDataSaga() {
  yield takeLatest(consts.INIT_DATA, workerSaga)
}


// worker saga: makes the api call when watcher saga sees the action
export function* workerDataSaga(request) {

  token = request.token.access

  try {

    let config = {
      method: 'post',
      url: `${consts.WORKLIST_API}/appls-list/`,
      headers: { 
        'Authorization': `Bearer ${token}`
      }
    }
  
    const response = yield call(axios, config);
    const data = response.data;


    // dispatch a success action to the store with the new dog
    yield put({ type: consts.API_TOKEN_SUCCESS, content: data });

  } catch (error) {
    // dispatch a failure action to the store with the error
    yield put({ type: consts.API_TOKEN_FAILURE, error });
  }
}
